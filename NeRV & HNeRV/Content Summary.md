# NeRV

## 摘要

我们提出了一种新颖的视频神经表示（NeRV），它在神经网络中对视频进行编码。与将视频视为帧序列的传统表示不同，我们将视频表示为以帧索引作为输入的神经网络。给定帧索引，NeRV 输出相应的 RGB 图像。 NeRV 中的视频编码只是将神经网络拟合到视频帧，而解码过程是一个简单的前馈操作。作为一种图像级隐式表示，NeRV 输出整个图像，与像素级隐式表示相比，表现出极高的效率，将编码速度提高了 25 倍到 70 倍，解码速度提高了 38 倍到 132 倍，同时实现了更好的视频质量。通过这样的表示，我们可以将视频视为神经网络，从而简化一些与视频相关的任务。例如，传统的视频压缩方法受到专为该任务设计的又长又复杂的管道的限制。相比之下，借助 NeRV，我们可以使用任何神经网络压缩方法作为视频压缩的代理，并实现与传统基于帧的视频压缩方法（H.264、HEVC 等）相当的性能。除了压缩之外，我们还演示了 NeRV 对视频去噪的泛化。

## 主要内容

- 我们提出NeRV，一种新颖的视频图像隐式表示，将视频表示为神经网络，将视频编码转换为模型拟合，并将视频解码作为简单的前馈操作。
- 与逐像素隐式表示相比，NeRV 输出整个图像并显示出很高的效率，将编码速度提高了 25 倍到 70 倍，解码速度提高了 38 倍到 132 倍，同时实现了更好的视频质量。
- NeRV 允许我们将视频压缩问题转换为模型压缩问题，使我们能够利用标准模型压缩工具并达到与传统视频压缩方法（例如 H.264 和 HEVC）相当的性能。
- 作为视频的一般表示，NeRV 在其他任务（例如视频去噪）中也显示出了有希望的结果。 NeRV 无需任何特殊的去噪设计，其性能优于传统的手工去噪算法（介质滤波器等）和基于 ConvNets 的去噪方法。

## 结论

在这项工作中，我们提出了一种新颖的视频神经表示形式 NeRV，它将视频编码到神经网络中。我们的重点是，通过直接训练具有视频帧索引的神经网络并输出相应的RGB图像，我们可以使用模型的权重来表示视频，这与将视频视为连续帧序列的传统表示完全不同。通过这样的表示，我们表明，通过简单地应用通用模型压缩技术，NeRV 可以在视频压缩任务中与传统视频压缩方法的性能相匹配，而无需设计长且复杂的管道。我们还表明 NeRV 的性能优于标准去噪方法。我们希望本文能够激发进一步的研究工作，设计一类新颖的视频表示方法。

## 局限性和未来的工作

拟议的 NeRV 有一些限制。首先，为了实现可比较的 PSNR 和 MS-SSIM 性能，我们提出的方法的训练时间比传统视频压缩方法的编码时间长。其次，NeRV的架构设计还不是最优的，我们相信在神经架构设计上进行更多的探索可以实现更高的性能。最后，更先进、最前沿的模型压缩方法可以应用于 NeRV 并获得更高的压缩比。



# HNeRV

## 摘要

隐式神经表示将视频存储为神经网络，并且在视频压缩和去噪等各种视觉任务中表现良好。使用帧索引或位置索引作为输入，隐式表示（NeRV、E-NeRV 等）从固定且与内容无关的嵌入重建视频帧。这种嵌入很大程度上限制了视频插值的回归能力和内部泛化。在本文中，我们提出了一种视频混合神经表示（HNeRV），其中可学习编码器生成内容自适应嵌入，充当解码器输入。除了输入嵌入之外，我们还引入了 HNeRV 块，它确保模型参数均匀分布在整个网络中，以便较高层（靠近输出的层）可以有更多容量来存储高分辨率内容和视频细节。凭借内容自适应嵌入和重新设计的架构，HNeRV 在视频回归任务中的重建质量（+4.7 PSNR）和收敛速度（快 16 倍）方面均优于隐式方法，并显示出更好的内部泛化能力。作为一种简单高效的视频表示，与传统编解码器（H.264、H.265）和基于学习的压缩方法相比，HNeRV 还显示出解码速度、灵活性和部署方面的优势。最后，我们探讨了 HNeRV 在视频压缩和视频修复等下游任务上的有效性。

## 主要内容

我们提出了一种可学习编码器作为视频混合神经表示的关键组件（HNeRV，图 1（顶部））。我们提出的神经表示是隐式（以网络为中心）和显式（以嵌入为中心）方法之间的混合因为它将视频存储为两部分：微小的内容自适应帧嵌入和学习的神经解码器。除了内容不可知嵌入的问题之外，NeRV 等先前的工作还存在模型参数分布不平衡的问题。在这些解码器中，稍后层（更接近输出图像）的参数比早期层（更接近嵌入）少得多。这阻碍了 NeRV 在保留帧细节的同时有效重建大量视频内容的能力。为了纠正这个问题，我们引入了 HNeRV 块，它增加了内核后期阶段的尺寸和通道宽度。使用 HNeRV 块，我们可以构建参数在整个网络上分布更均匀的视频解码器。作为一种混合方法，HNeRV 提高了视频回归的重建质量，并将收敛速度提高了 16 × 与隐式方法相比，如图 1（底部）所示。通过内容自适应嵌入，HNeRV 还表现出更好的内部泛化能力（对训练期间未看到的视频帧进行编码和解码的能力），我们通过第 4.2 节中的帧插值结果验证了这一点。

HNeRV只需要进行视频解码的网络前向操作，与传统的视频解码相比具有很大的优势。在速度、灵活性和易于部署方面，它与传统编解码器和先前的深度学习方法相比。此外，大多数其他视频压缩方法都是自回归的，并且高度依赖于视频帧的顺序。相比之下，HNeRV 不依赖于帧的顺序，这意味着它可以有效地随机访问帧以并行解码帧。这种简单性和并行性使 HNeRV 成为进一步加速的良好编解码器，例如特殊的神经处理单元 (NPU) 芯片或大批量并行解码。

HNeRV 对于视频压缩仍然可行，同时在视频恢复任务中也显示出良好的性能。我们设计的编码器也可以被压缩；此外，我们的 HNeRV 解码器块在模型压缩机制中表现良好，因此 HNeRV 与最先进的方法具有竞争力。我们假设神经表示对于像素空间中的失真具有鲁棒性，因此可以恢复已失真的视频。

总之，我们提出了一种视频的混合神经表示。通过内容自适应嵌入和重新设计的架构，HNeRV 在重建质量（+4.7 PSNR）、收敛速度（快 16 倍）和内部泛化方面表现出比隐式方法更好的视频回归性能。 HNeRV作为一种高效的视频编解码器，易于部署，视频解码简单、快速、灵活。最后，HNeRV 在视频压缩和视频修复等下游任务中表现出良好的性能。

## 结论

在本文中，我们提出了视频的混合神经表示（HNeRV）。通过内容自适应嵌入和均匀分布的参数，与隐式方法相比，HNeRV 在重建质量、收敛速度方面提高了视频回归性能和内部概括。作为一种视频表示，HNeRV 的视频解码也简单、快速、灵活，并且在视频压缩和修复方面表现出良好的性能。

## 局限性

首先，作为神经表示，HNeRV 将每个视频存储为神经网络。给定一个新视频，HNeRV 仍然需要时间来训练以适应视频。其次，虽然 HNeRV 可以很好地表示视频，但找到最合适的嵌入大小、模型大小和网络架构（K、r 等）仍然是一个悬而未决的问题。最后，虽然增加后面层的内核大小和通道宽度可以很大程度上提高回归性能，但它会稍微减慢网络速度。