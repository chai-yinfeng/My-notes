# HNeRV: A Hybrid Neural Representation for Videos

# 论文翻译及解读

## 标题：[HNeRV: A Hybrid Neural Representation for Videos](https://arxiv.org/pdf/2304.02633)

## 作者

- Hao Chen
- M. Gwilliam
- S. Lim
- Abhinav Shrivastava

## 摘要 

隐式神经表示将视频存储为神经网络，并已在各种视觉任务中表现良好，例如视频压缩和去噪。通过帧索引或位置索引作为输入，隐式表示（如NeRV、E-NeRV等）从固定和内容不可知的嵌入中重建视频帧。这种嵌入在很大程度上限制了视频插值的回归能力和内部泛化。在本文中，我们提出了一种用于视频的混合神经表示（HNeRV），其中一个可学习的编码器生成内容自适应的嵌入，这些嵌入作为解码器的输入。除了输入嵌入，我们还引入了HNeRV块，确保模型参数在整个网络中均匀分布，这样较高的层（接近输出的层）可以有更多的容量来存储高分辨率的内容和视频细节。通过内容自适应的嵌入和重新设计的架构，HNeRV在视频回归任务中的重建质量（+4.7 PSNR）和收敛速度（快16倍）上均优于隐式方法，并显示出更好的内部泛化。作为一种简单而高效的视频表示，与传统的编解码器（如H.264、H.265）和基于学习的压缩方法相比，HNeRV还显示出解码速度、灵活性和部署方面的优势。最后，我们探讨了HNeRV在下游任务（如视频压缩和视频修复）上的有效性。

## 1.引言

- 每天都有大量的视频被生成，因此有效地存储和传输它们是计算机视觉和视频处理中的关键任务。即使对于现代存储系统，原始视频数据的空间需求也可能是压倒性的。尽管存储变得更便宜，但网络速度和I/O处理仍然是瓶颈，使得传输和处理视频变得昂贵。

### 传统的视频编解码器

- 传统的视频编解码器，如H.264和HEVC，依赖于基于离散余弦变换的手动设计的编码器和解码器。随着深度学习的成功，许多尝试已经被制定，以用神经网络替代现有压缩流水线的某些组件。尽管这些基于学习的压缩方法在速率失真性能方面显示出很高的潜力，但它们受到复杂的流水线和昂贵的计算的困扰，不仅需要训练，还需要编码和解码。

### 隐式神经表示

- 为了解决复杂的流水线和重计算问题，隐式神经表示由于其简单性、紧凑性和效率而变得受欢迎。这些方法显示出对视觉数据压缩的巨大潜力，如COIN用于图像压缩，NeRV用于视频压缩。通过将视频表示为神经网络，视频压缩问题可以转化为模型压缩问题，从而大大简化了编码和解码流水线。

### 隐式表示方法的权衡

- 用于视频压缩的隐式表示方法存在一个主要的权衡：它们以牺牲泛化性为代价来实现简单性。NeRV使用固定的位置编码函数和一个可学习的解码器从时间嵌入中重建视频帧。E-NeRV采用时间嵌入和空间嵌入来重建视频帧。由于NeRV和E-NeRV的嵌入基于空间和/或时间信息，它们是内容不可知的。这种方法有一些主要的缺点。首先，由于嵌入是内容不可知的，因此无法有意义地在帧之间进行插值。其次，位置嵌入为完全隐式模型提供了没有视觉先验的信息，并限制了回归能力，因为所有的信息都需要由视频解码器学习和存储。

### HNeRV的优势

- HNeRV只需要一个网络前向操作来进行视频解码，这相对于传统的编解码器和之前的深度学习方法在速度、灵活性和部署方面都有很大的优势。
- 大多数其他的视频压缩方法都是自回归的，视频帧的顺序有很高的依赖性。与此相反，HNeRV没有帧的顺序依赖性，这意味着它可以有效地随机访问帧来并行解码帧。这种简单性和并行性使HNeRV成为进一步加速的好编解码器，如特殊的神经处理单元(NPU)芯片，或使用大批量进行并行解码。

### HNeRV的应用

- HNeRV仍然适用于视频压缩，同时在视频修复任务中也显示出有希望的性能。我们设计了一个编码器，使其也可以被压缩；此外，我们的HNeRV解码器块在模型压缩领域表现良好，使HNeRV能与最先进的方法相媲美。我们认为神经表示可以对像素空间的失真具有鲁棒性，因此可以修复经过失真的视频。我们在视频修复任务上验证了这一观察。

## 2.相关工作

- **神经表示**：隐式表示适应于每个单独的测试信号，其中模型被回归到给定的图像、场景或视频。大多数隐式神经表示都是基于坐标的。这些基于坐标的隐式表示用于图像重建、形状回归和3D视图合成。
- **视频压缩**：传统的视频压缩方法如MPEG、H.264和H.265在解压速度和良好的重建结果方面表现出色。最近，深度学习技术已被提议用于视频压缩。这些方法主要是替代整个压缩流水线，它们各自借鉴了传统手工方法的原理。
- **模型压缩**：NeRV将视频压缩视为模型压缩，这是一个多样化的领域。在这篇论文中，我们只应用了可能方法的一小部分。我们使用了权重修剪和权重量化。我们还使用了熵编码进行无损压缩。
- **视频修复和内部学习**：视频修复通常被视为对象移除和尝试重新创建图像缺失区域的某种组合。有些方法依赖于从大型数据集上的先验，而我们的方法更接近于最近的零射击全内部方法。

## 3.方法

### HNeRV概述

- HNeRV是一个“混合”表示，结合了显式和隐式方法的优势。与简单的自动编码器不同，后者对所有视频使用一个模型并具有大的帧嵌入，HNeRV为每个视频拟合一个模型，并具有微小的帧嵌入。
- 显式方法使用自动编码器对所有视频进行编码和解码，并将内容明确地存储为潜在嵌入。给定一个视频特定的嵌入作为输入，解码器可以重建视频。隐式方法仅使用一个可学习的解码器来表示视频。给定固定的帧索引作为输入，视频特定的解码器可以重建视频。
- 与隐式表示相似，我们使用一个可学习的解码器单独对视频进行建模，并在视频特定的解码器中隐式地存储大部分内容。为了实现更好的重建，我们使用一个可学习的嵌入作为输入，并在这些帧特定的嵌入中明确地存储信息，这与显式方法相似。因此，我们可以使用任何强大的编码器生成微小的内容自适应嵌入以提高隐式表示的性能。由于这些嵌入非常小（例如，640×1280帧的128-d向量），我们的混合神经表示与隐式方法一样紧凑，但具有更强的容量、更快的收敛速度和更好的内部泛化，同时保持了下游任务的全部潜力。

- HNeRV块与NeRV块类似，都由三个层组成：卷积层、像素洗牌层和激活层。在每个块中，只有卷积层具有可学习的参数。与NeRV块相比，HNeRV块在后期阶段使用更大的内核大小和更宽的通道，使其在存储高分辨率视频内容方面更为强大。

### 下游任务

- **视频压缩**：我们利用模型压缩和嵌入量化进行视频压缩。与NeRV类似，我们应用全局非结构化修剪、模型量化和权重熵编码进行模型压缩。
- **视频修复**：对于部分失真的视频，我们只计算非遮罩像素的损失。对于修复输出，我们使用HNeRV的输出填充遮罩区域。

## 4.实验

- **数据集和实现细节**：论文提供了复制结果所需的信息，包括使用的数据集和超参数设置。
- **视频回归**：展示了视频回归的主要结果。
- **解码器参数重新分配的有效性**：展示了解码器参数重新分配对提高高分辨率帧外观的有效性。
- **下游任务**：展示了解码速度、视频压缩、内部泛化和视频修复等下游任务的初步结果。